<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Forgot password — ToDoList</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 520px; margin: 40px auto; padding: 0 16px; }
        .card { border: 1px solid #ddd; border-radius: 12px; padding: 18px; }
        input { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 8px; margin: 8px 0 14px; }
        button { padding: 10px 14px; border: 0; border-radius: 8px; background: #111; color: #fff; cursor: pointer; }
        .hint { color: #666; font-size: 14px; }
        .msg { margin-top: 12px; padding: 10px; border-radius: 8px; background: #f5f5f5; }
    </style>
</head>
<body>
<h2>Forgot password</h2>

<div class="card">
    <p class="hint">
        Enter your email. If an account exists, we’ll send a password reset link.
    </p>

    <label>Email</label>
    <input id="email" type="email" placeholder="you@example.com" required />

    <button id="btn">Send reset link</button>

    <div id="msg" class="msg" style="display:none;"></div>
</div>

<script>
    const btn = document.getElementById('btn');
    const msg = document.getElementById('msg');

    btn.addEventListener('click', async () => {
        const email = document.getElementById('email').value.trim();
        if (!email) return;

        btn.disabled = true;
        msg.style.display = "none";

        try {
            const res = await fetch('/api/auth/forgot-password', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email })
            });

            // даже если email не существует — по безопасности обычно всё равно OK
            if (!res.ok) {
                // на всякий случай
                throw new Error('Request failed');
            }

            msg.textContent = "If an account exists for this email, we sent a reset link. Please check your inbox.";
            msg.style.display = "block";
        } catch (e) {
            msg.textContent = "Something went wrong. Please try again later.";
            msg.style.display = "block";
        } finally {
            btn.disabled = false;
        }
    });
</script>
</body>
</html>
